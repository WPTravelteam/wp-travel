function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?ownKeys(Object(c),!0).forEach(function(b){_defineProperty(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):ownKeys(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function GetConvertedPrice(a){var b="undefined"!=typeof _wp_travel&&void 0!==_wp_travel.conversion_rate?_wp_travel.conversion_rate:1,c="undefined"!=typeof _wp_travel&&void 0!==_wp_travel.number_of_decimals?_wp_travel.number_of_decimals:2;return b=parseFloat(b).toFixed(2),parseFloat(a*b).toFixed(c)}jQuery(document).ready(function(a){"undefined"!=typeof parsley&&a(".wp-travel-add-to-cart-form").parsley(),a(".wp-travel-add-to-cart-form").submit(function(b){b.preventDefault();var c="#"+a(this).attr("id"),d={};a(c+" input, "+c+" select").each(function(b){var c=a(this).attr("name"),e=a(this).val();if(1==a(this).data("multiple")){if(void 0===d[c]&&(d[c]=[]),"checkbox"==a(this).attr("type")&&a(this).is(":checked")&&d[c].push(e),1==a(this).data("dependent")){var f=a(this).data("parent");a("#"+f).is(":checked")&&d[c].push(e)}}else d[c]=e}),d.action="wt_add_to_cart",d._nonce=wp_travel._nonce,a.ajax({type:"POST",url:wp_travel.ajaxUrl,data:d,beforeSend:function(){},success:function(a){wp_travel.isEnabledCartPage?location.href=wp_travel.cartUrl:location.href=wp_travel.checkoutUrl}})}),a(".wp-travel-cart-remove").click(function(b){if(b.preventDefault(),confirm(wp_travel.strings.confirm)){var c=a(this).data("cart-id");a.ajax({type:"POST",url:wp_travel.ajaxUrl,data:{action:"wt_remove_from_cart",cart_id:c},beforeSend:function(){},success:function(a){location.href=wp_travel.cartUrl}})}}),a(".wp-travel-update-cart-btn").click(function(b){b.preventDefault();var c={};a(".ws-theme-cart-page tr.responsive-cart").each(function(b){var d=a(this).find('input[name="cart_id"]').val(),e=a(this).find('input[name="pricing_id"]').val(),f=!1,g=!1,h={};a(this).find("input.wp-travel-trip-pax").each(function(){h[a(this).data("category-id")]=this.value});var i={};i.extras={},i.extras.id={},i.extras.qty={},i.pax=h,i.pricing_id=e,i.cart_id=d,a(this).next(".child_products").find('input[name="extra_id"]').length>0&&a(this).next(".child_products").find('input[name="extra_id"]').each(function(b){f=a(this).val(),i.extras.id[b]=f}),a(this).next(".child_products").find('input[name="extra_qty"]').length>0&&a(this).next(".child_products").find('input[name="extra_qty"]').each(function(b){g=a(this).val(),i.extras.qty[b]=g}),c[b]=i}),a.ajax({type:"POST",url:wp_travel.ajaxUrl,data:{update_cart_fields:c,action:"wt_update_cart"},beforeSend:function(){},success:function(a){a&&location.reload()}})}),a(".wp-travel-apply-coupon-btn").click(function(b){b.preventDefault();var c={};a(".ws-theme-cart-page tr.responsive-cart").each(function(b){trip_id=a(this).find('input[name="trip_id"]').val(),c[b]=trip_id});var d=a('input[name="wp_travel_coupon_code_input"]').val();a.ajax({type:"POST",url:wp_travel.ajaxUrl,data:{trip_ids:c,CouponCode:d,action:"wt_cart_apply_coupon"},beforeSend:function(){},success:function(a){a&&location.reload()}})}),a(".wp-travel-pax, .wp-travel-tour-extras-qty").on("change",function(){a(".wp-travel-update-cart-btn").removeAttr("disabled","disabled"),a(".book-now-btn").attr("disabled","disabled")}),a(document).on("click",".wp-travel-add-traveller",function(b){b.preventDefault();var c=a(this).parent(".text-center").siblings(".payment-content").find(".payment-traveller").length,d=a(".payment-content .payment-traveller:last").data("unique-index");d?d+=1:d=c;var e=a(this).data("cart-id"),f=wp.template("traveller-info");a(this).closest(".text-center").siblings(".payment-content").append(JSON.parse(f({index:c,cart_id:e,unique_index:d})))}),a(document).on("click",".traveller-remove",function(b){b.preventDefault(),confirm("Are you sure you want to traveler?")&&(a(this).closest(".payment-traveller").remove(),a(".payment-traveller.added").each(function(b){a(this).find(".traveller-index").html(b+1)}))}),a(document).on("click, change",".wp-travel-pax",function(){var b=a(this),c=b.closest(".product-price"),d=c.data("maxPax"),e=c.data("minPax"),f=0;c.find(".wp-travel-pax").each(function(a){f+=parseInt(this.value)}),f>d?(alert(wp_travel.strings.alert.max_pax_alert.replace("{max_pax}",d)),b.val(parseInt(d)+parseInt(b.val())-parseInt(f)),a(".wp-travel-update-cart-btn").removeAttr("disabled")):f<e?(alert(wp_travel.strings.alert.min_pax_alert.replace("{min_pax}",e)),a(".wp-travel-update-cart-btn").attr("disabled","disabled")):a(".wp-travel-update-cart-btn").removeAttr("disabled")})});var wp_travel_cart={};wp_travel_cart.format=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"currency",c=wp_travel,d=(c.currency,c.currency_symbol),e=c.currency_position,f=c.decimal_separator,g=c.number_of_decimals,h=c.thousand_separator,i=new RegExp("\\d(?=(\\d{3})+\\".concat(f,")"),"gi"),j="$&".concat(h),k=parseFloat(a).toFixed(g).replace(/\./,f).replace(i,j);return"decimal"==b?k:{left:"".concat(d,"<span>").concat(k,"</span>"),left_with_space:"".concat(d," <span>").concat(k,"</span>"),right:"<span>".concat(k,"</span>").concat(d),right_with_space:"<span>".concat(k,"</span> ").concat(d)}[e]},wp_travel_cart.timeout=function(a,b){return new Promise(function(c,d){setTimeout(function(){d(new Error("request timeout"))},b),c(a.then(c,d))})};var wptravelcheckout=function(a){function b(a){var b=1;return"-"===a[0]&&(b=-1,a=a.substr(1)),function(c,d){return(c[a]<d[a]?-1:c[a]>d[a]?1:0)*b}}var c=document.getElementById("wp-travel-book-now");if(c&&c.addEventListener("wptcartchange",function(a){a.target.disabled=!0}),c&&c.addEventListener("click",function(a){}),a){var d=a&&a.querySelectorAll("[data-cart-id]");if(!(d&&d.length<=0)){var e=function(){var b=a.querySelectorAll("[data-dirty]");c&&(b&&b.length>0?c.disabled=!0:c.disabled=!1)},f=function(a){a?g.removeAttribute("style"):g.style.display="none"},g=a.querySelector(".wp-travel-cart-loader");g&&f(!0),wp_travel&&wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?action=wp_travel_get_cart&_nonce=").concat(wp_travel._nonce)).then(function(a){a.json().then(function(a){f(),a.success&&"WP_TRAVEL_CART"===a.data.code&&a.data.cart&&(wp_travel_cart.cart=a.data.cart,Object.freeze(wp_travel_cart.cart))})}),1e4).catch(function(a){alert("[X] Request Timeout!"),f()});var h=function(c){var d={},e=0,f=0,g=0,h=0,i=wp_travel_cart.cart&&wp_travel_cart.cart.cart_items&&wp_travel_cart.cart.cart_items[c];console.log("item",i.trip_data.pricings);var j=a.querySelector('[data-cart-id="'.concat(c,'"]')),k=i.trip_data.pricings.find(function(a){return a.id==parseInt(i.pricing_id)}),l=k.categories,m=k.trip_extras,n=j.querySelectorAll("[data-wpt-category-count]"),o=i.trip_data&&i.trip_data.minimum_partial_payout_percent,p=j.querySelectorAll("[data-wpt-category]"),q=0;p.forEach(function(a){var b=a.querySelector("[data-wpt-category-count-input]"),c=b&&parseInt(b.value)||0;q+=c}),p.forEach(function(a){var c=a.querySelector("[data-wpt-category-total]"),d=a.querySelector("[data-wpt-category-count-input]"),g=a.querySelector("[data-wpt-category-price]"),i=l.find(function(b){return b.id==parseInt(a.dataset.wptCategory)}),j=i&&i.is_sale?parseFloat(i.sale_price):parseFloat(i.regular_price);j=GetConvertedPrice(j),g.innerHTML=wp_travel_cart.format(j);var m=d&&parseInt(d.value)||0;if(void 0!==k.has_group_price&&k.has_group_price&&k.group_prices&&k.group_prices.length>0){var p=k.group_prices;p=p.sort(b("max_pax"));var r=p.find(function(a){return parseInt(a.min_pax)<=q&&parseInt(a.max_pax)>=q});r&&r.price&&(j=parseFloat(r.price),j=GetConvertedPrice(j),g&&(g.innerHTML=wp_travel_cart.format(j)))}else if(i.has_group_price){var s=i.group_prices.find(function(a){return m>=parseInt(a.min_pax)&&m<=parseInt(a.max_pax)});s&&s.price&&(j=s.price,j=GetConvertedPrice(j)),g&&(g.innerHTML=wp_travel_cart.format(j))}var t="group"==i.price_per?m>0&&j||0:j*m;n&&n.forEach(function(b){b.dataset.wptCategoryCount==a.dataset.wptCategory&&(b.innerHTML=m)}),c&&(c.innerHTML=wp_travel_cart.format(t)),h+=parseFloat(t),e+=parseFloat(t),f+=parseFloat(t)*parseFloat(o)/100});var r=j.querySelectorAll("[data-wpt-tx]");return r&&r.forEach(function(a){var b=m.find(function(b){return b.id==parseInt(a.dataset.wptTx)});if(b.tour_extras_metas){var c=a.querySelector("[data-wpt-tx-total]"),d=a.querySelector("[data-wpt-tx-count-input]"),e=a.querySelector("[data-wpt-tx-price]"),f=b.is_sale&&b.tour_extras_metas.extras_item_sale_price||b.tour_extras_metas.extras_item_price;f=GetConvertedPrice(f),e.innerHTML=wp_travel_cart.format(f);var i=d&&d.value||0,j=parseFloat(f)*parseInt(i);c&&(c.innerHTML=wp_travel_cart.format(j)),h+=j,g+=j}}),d={tripTotalWOExtras:e,tripTotalPartialWOExtras:f,extrasTotal:g,tripTotal:h},j.querySelector("[data-wpt-item-total]").innerHTML=wp_travel_cart.format(h),d};a&&a.addEventListener("wptcartchange",function(a){var b=0,c=0,d=0,e=0,f=document.querySelectorAll("[data-wpt-cart-net-total]"),g=document.querySelectorAll("[data-wpt-cart-partial-total]"),i=a.target.querySelector("[data-wpt-cart-subtotal]"),j=a.target.querySelector("[data-wpt-cart-discount]"),k=a.target.querySelector("[data-wpt-cart-tax]"),l=a.target.querySelectorAll("[data-cart-id]");if(l&&l.forEach(function(a){var f=h(a.dataset.cartId);b+=f.tripTotal,c+=f.tripTotalWOExtras,e+=f.tripTotalPartialWOExtras,d+=f.extrasTotal}),i&&(i.innerHTML=wp_travel_cart.format(b)),a.detail&&a.detail.coupon||wp_travel_cart.cart.coupon&&wp_travel_cart.cart.coupon.coupon_id){var m=a.detail&&a.detail.coupon||wp_travel_cart.cart.coupon,n=m.value&&parseInt(m.value)||0;j&&(j.innerHTML="fixed"==m.type?"- "+wp_travel_cart.format(n):"- "+wp_travel_cart.format(b*n/100),j.closest("[data-wpt-extra-field]").removeAttribute("style")),b="fixed"==m.type?b-n:b*(100-n)/100}wp_travel_cart.cart.total.discount<=0&&(j.closest("[data-wpt-extra-field]").style.display="none"),wp_travel_cart.cart.tax&&(k&&(k.innerHTML="+ "+wp_travel_cart.format(b*parseInt(wp_travel_cart.cart.tax)/100)),b=b*(100+parseInt(wp_travel_cart.cart.tax))/100),f&&f.forEach(function(a){return a.innerHTML=wp_travel_cart.format(b)}),g&&g.forEach(function(a){var b=e+d;wp_travel_cart.cart.tax&&(b=b*(100+parseFloat(wp_travel_cart.cart.tax))/100),a.innerHTML=wp_travel_cart.format(b)});var o=a.target.querySelector("[data-wpt-cart-item-count]");o&&(o.innerHTML=l.length)}),d&&d.forEach(function(b){var d=b.querySelector("a.edit"),e=b.querySelector(".update-fields-collapse"),g=b.querySelector(".del-btn"),h=b.querySelector(".wp-travel-cart-loader");g&&g.addEventListener("click",function(c){c.preventDefault(),confirm(g.dataset.l10n)&&(f(!0),wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?action=wp_travel_remove_cart_item&_nonce=").concat(wp_travel._nonce,"&cart_id=").concat(b.dataset.cartId)).then(function(a){return a.json()}).then(function(c){if(c.success&&"WP_TRAVEL_REMOVED_CART_ITEM"==c.data.code){window.location.reload(),wp_travel_cart.cart=c.data.cart;var d=c.data.cart.total;wp_travel.payment&&(wp_travel.payment.trip_price=parseFloat(d.total),wp_travel.payment.payment_amount=parseFloat(d.total_partial)),b.remove(),a.dispatchEvent(new Event("wptcartchange")),f()}}),1e4).catch(function(a){alert("[X] Request Timeout!"),f()}))}),d&&d.addEventListener("click",function(a){if(e.className.indexOf("active")<0?(e.style.display="block",e.classList.add("active")):(e.style.display="none",e.classList.remove("active")),!(e.className.indexOf("active")<0)){var c=a.target.dataset.wptTargetCartId,d=wp_travel_cart.cart.cart_items&&wp_travel_cart.cart.cart_items[c]||{};if(d.trip_data&&d.trip_data.inventory&&"yes"===d.trip_data.inventory.enable_trip_inventory){var f="",g=d.pricing_id||0;f+=g&&"pricing_id=".concat(g)||"";var i=d.trip_data&&d.trip_data.id||0;f+=i&&"&trip_id=".concat(i)||"";var j=d.trip_time;if(f+=j&&"&trip_time=".concat(j)||"",d.arrival_date&&"invalid date"!=new Date(d.arrival_date).toString().toLowerCase()){var k=new Date(d.arrival_date),l=k.getFullYear(),m=k.getMonth()+1;m=String(m).padStart(2,"0");var n=String(k.getDate()).padStart(2,"0");k="".concat(l,"-").concat(m,"-").concat(n),f+=k&&"&selected_date=".concat(k)||""}h.removeAttribute("style"),wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?").concat(f,"&action=wp_travel_get_inventory&_nonce=").concat(wp_travel._nonce)).then(function(a){return a.json().then(function(a){if(h.style.display="none",a.success&&"WP_TRAVEL_INVENTORY_INFO"===a.data.code&&a.data.inventory.length>0){var c=a.data.inventory[0];b.querySelectorAll("[data-wpt-category-count-input]").forEach(function(a){return a.max=c.pax_available})}})})).catch(function(a){alert("[X] Request Timeout!"),h.style.display="none"})}}});var i=b.querySelectorAll("[data-wpt-category], [data-wpt-tx]");i&&i.forEach(function(d){var e=d.querySelector("[data-wpt-category-count-input], [data-wpt-tx-count-input]"),f=d.querySelectorAll("[data-wpt-count-up],[data-wpt-count-down]");f&&f.forEach(function(d){d.addEventListener("click",function(f){f.preventDefault();var g=0;if(b.querySelectorAll("[data-wpt-category-count-input]").forEach(function(a){g+=parseInt(a.value)}),void 0!==d.dataset.wptCountUp)if(e&&e.dataset.wptCategoryCountInput){var h=parseInt(e.value)+1<0?0:parseInt(e.value)+1;g+1<=parseInt(e.max)&&h>=parseInt(e.min)&&(e.value=h)}else e.value=parseInt(e.value)+1;if(void 0!==d.dataset.wptCountDown)if(e&&e.dataset.wptCategoryCountInput){var i=parseInt(e.value)-1<0?0:parseInt(e.value)-1;g-1<=parseInt(e.max)&&i>=parseInt(e.min)&&(e.value=i)}else e.value=parseInt(e.value)-1<parseInt(e.min)?e.min:parseInt(e.value)-1;a.dispatchEvent(new Event("wptcartchange")),c&&c.dispatchEvent(new Event("wptcartchange")),b.querySelector('form [type="submit"]').disabled=!1,b.querySelector("h5 a").style.color="orange"})})})}),d&&d.forEach(function(a){var b=a.querySelector(".wp-travel-cart-loader"),c=a.querySelectorAll("[data-wpt-category]"),d=a.querySelectorAll("[data-wpt-tx]"),f=a.querySelector("form");f.addEventListener("submit",function(g){g.preventDefault();var h=f.querySelector('[type="submit"]');h.disabled=!0,b.removeAttribute("style");var i=a.dataset.cartId,j={};c&&c.forEach(function(a){var b=a.querySelector("[data-wpt-category-count-input]"),c=a.dataset.wptCategory,d=b&&b.value;j=_objectSpread(_objectSpread({},j),{},_defineProperty({},c,d))});var k={};d&&d.forEach(function(a){var b=a.querySelector("[data-wpt-tx-count-input]"),c=a.dataset.wptTx,d=b&&b.value;k=_objectSpread(_objectSpread({},k),{},_defineProperty({},c,d))});var l={pax:j,wp_travel_trip_extras:{id:Object.keys(k),qty:Object.values(k)}};wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?action=wp_travel_update_cart_item&cart_id=").concat(i,"&_nonce=").concat(wp_travel._nonce),{method:"POST",body:JSON.stringify(l)}).then(function(a){return a.json()}).then(function(c){if(b.style.display="none",c.success){wp_travel_cart.cart=c.data.cart;var d=c.data.cart.total;wp_travel.payment&&(wp_travel.payment.trip_price=parseFloat(d.total),wp_travel.payment.payment_amount=parseFloat(d.total_partial)),e(),a.querySelector("h5 a").removeAttribute("style"),location.reload()}else h.disabled=!1}),1e4).catch(function(a){alert("[X] Request Timeout!"),b.style.display="none",h.disabled=!1})})});var i=document.getElementById("wp-travel-payment-mode");i&&i.addEventListener("change",function(a){var b=document.querySelector("#shopping-cart"),c=b&&b.querySelector("[data-wpt-cart-partial-total]")&&b.querySelector("[data-wpt-cart-partial-total]").closest("p"),d=b&&b.querySelectorAll("[data-wpt-trip-partial-total]")&&b.querySelectorAll("[data-wpt-trip-partial-total]"),e=b&&b.querySelectorAll(".wp-travel-payable-amount")&&b.querySelector(".wp-travel-payable-amount"),f=b&&b.querySelectorAll("[data-wpt-trip-partial-gross-total]")&&b.querySelector("[data-wpt-trip-partial-gross-total]");"partial"===a.target.value?(c&&"none"==c.style.display&&c.removeAttribute("style"),d.forEach(function(a){return a.removeAttribute("style")}),f.removeAttribute("style"),f.classList.add("selected-payable-amount"),e.classList.remove("selected-payable-amount")):(c&&(c.style.display="none"),d.forEach(function(a){return a.style.display="none"}),f.style.display="none",f.classList.remove("selected-payable-amount"),e.classList.add("selected-payable-amount"))});var j=document.getElementById("wp-travel-coupon-form"),k=j&&j.querySelector("button"),l=j&&j.querySelector(".coupon-input-field");l&&l.addEventListener("keyup",function(a){m(a.target),a.target.value.length>0&&a.target.removeAttribute("style")});var m=function(a,b){if(b){var c=document.createElement("p");c.classList.add("error"),c.innerHTML=b,a.after(c)}else{var d=a.parentElement.querySelector(".error");d&&d.remove()}};k&&l&&k.addEventListener("click",function(b){b.preventDefault(),l.value.length<=0?(l.style.borderColor="red",l.focus()):(f(!0),b.target.disabled=!0,wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?action=wp_travel_apply_coupon&_nonce=").concat(wp_travel._nonce),{method:"POST",body:JSON.stringify({couponCode:l.value})}).then(function(a){return a.json()}).then(function(c){f(),c.success?(wp_travel_cart.cart=c.data.cart,l.toggleAttribute("readonly"),b.target.innerHTML=b.target.dataset.successL10n,b.target.style.backgroundColor="green",a.dispatchEvent(new CustomEvent("wptcartchange",{detail:{coupon:c.data.cart.coupon}})),location.reload()):(l.focus(),m(l,c.data[0].message),b.target.disabled=!1)}),1e4).catch(function(a){alert("[X] Request Timeout!"),f()}))})}}};document.getElementById("shopping-cart")&&wptravelcheckout(document.getElementById("shopping-cart"));