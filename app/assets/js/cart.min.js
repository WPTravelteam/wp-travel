function ownKeys(e,t){var a,r=Object.keys(e);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(e),t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)),r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(a),!0).forEach(function(t){_defineProperty(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function _defineProperty(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function GetConvertedPrice(t){var e="undefined"!=typeof _wp_travel&&void 0!==_wp_travel.conversion_rate?_wp_travel.conversion_rate:1,a="undefined"!=typeof _wp_travel&&void 0!==_wp_travel.number_of_decimals?_wp_travel.number_of_decimals:2,e=parseFloat(e).toFixed(2);return parseFloat(t*e).toFixed(a)}jQuery(document).ready(function(i){"undefined"!=typeof parsley&&i(".wp-travel-add-to-cart-form").parsley(),i(".wp-travel-add-to-cart-form").submit(function(t){t.preventDefault();var t="#"+i(this).attr("id"),n={};i(t+" input, "+t+" select").each(function(t){var e,a=i(this).attr("name"),r=i(this).val();1==i(this).data("multiple")?(void 0===n[a]&&(n[a]=[]),"checkbox"==i(this).attr("type")&&i(this).is(":checked")&&n[a].push(r),1==i(this).data("dependent")&&(e=i(this).data("parent"),i("#"+e).is(":checked")&&n[a].push(r))):n[a]=r}),n.action="wt_add_to_cart",n._nonce=wp_travel._nonce,i.ajax({type:"POST",url:wp_travel.ajaxUrl,data:n,beforeSend:function(){},success:function(t){wp_travel.isEnabledCartPage?location.href=wp_travel.cartUrl:location.href=wp_travel.checkoutUrl}})}),i(".wp-travel-cart-remove").click(function(t){t.preventDefault(),confirm(wp_travel.strings.confirm)&&(t=i(this).data("cart-id"),i.ajax({type:"POST",url:wp_travel.ajaxUrl,data:{action:"wt_remove_from_cart",cart_id:t},beforeSend:function(){},success:function(t){location.href=wp_travel.cartUrl}}))}),i(".wp-travel-update-cart-btn").click(function(t){t.preventDefault();var l={};i(".ws-theme-cart-page tr.responsive-cart").each(function(t){var e,a,r=i(this).find('input[name="cart_id"]').val(),n=i(this).find('input[name="pricing_id"]').val(),c={},o=(i(this).find("input.wp-travel-trip-pax").each(function(){c[i(this).data("category-id")]=this.value}),{});o.extras={},o.extras.id={},o.extras.qty={},o.pax=c,o.pricing_id=n,o.cart_id=r,0<i(this).next(".child_products").find('input[name="extra_id"]').length&&i(this).next(".child_products").find('input[name="extra_id"]').each(function(t){e=i(this).val(),o.extras.id[t]=e}),0<i(this).next(".child_products").find('input[name="extra_qty"]').length&&i(this).next(".child_products").find('input[name="extra_qty"]').each(function(t){a=i(this).val(),o.extras.qty[t]=a}),l[t]=o}),i.ajax({type:"POST",url:wp_travel.ajaxUrl,data:{update_cart_fields:l,action:"wt_update_cart"},beforeSend:function(){},success:function(t){t&&location.reload()}})}),i(".wp-travel-apply-coupon-btn").click(function(t){t.preventDefault();var e={},t=(i(".ws-theme-cart-page tr.responsive-cart").each(function(t){trip_id=i(this).find('input[name="trip_id"]').val(),e[t]=trip_id}),i('input[name="wp_travel_coupon_code_input"]').val());i.ajax({type:"POST",url:wp_travel.ajaxUrl,data:{trip_ids:e,CouponCode:t,action:"wt_cart_apply_coupon"},beforeSend:function(){},success:function(t){t&&location.reload()}})}),i(".wp-travel-pax, .wp-travel-tour-extras-qty").on("change",function(){i(".wp-travel-update-cart-btn").removeAttr("disabled","disabled"),i(".book-now-btn").attr("disabled","disabled")}),i(document).on("click",".wp-travel-add-traveller",function(t){t.preventDefault();var t=i(this).parent(".text-center").siblings(".payment-content").find(".payment-traveller").length,e=i(".payment-content .payment-traveller:last").data("unique-index"),a=(e?e+=1:e=t,i(this).data("cart-id")),r=wp.template("traveller-info");i(this).closest(".text-center").siblings(".payment-content").append(JSON.parse(r({index:t,cart_id:a,unique_index:e})))}),i(document).on("click",".traveller-remove",function(t){t.preventDefault(),confirm("Are you sure you want to traveler?")&&(i(this).closest(".payment-traveller").remove(),i(".payment-traveller.added").each(function(t){i(this).find(".traveller-index").html(t+1)}))}),i(document).on("click, change",".wp-travel-pax",function(){var t=i(this),e=t.closest(".product-price"),a=e.data("maxPax"),r=e.data("minPax"),n=0;e.find(".wp-travel-pax").each(function(t){n+=parseInt(this.value)}),a<n?(alert(wp_travel.strings.alert.max_pax_alert.replace("{max_pax}",a)),t.val(parseInt(a)+parseInt(t.val())-parseInt(n)),i(".wp-travel-update-cart-btn").removeAttr("disabled")):n<r?(alert(wp_travel.strings.alert.min_pax_alert.replace("{min_pax}",r)),i(".wp-travel-update-cart-btn").attr("disabled","disabled")):i(".wp-travel-update-cart-btn").removeAttr("disabled")})});var wp_travel_cart={format:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"currency",a=wp_travel,r=(a.currency,a.currency_symbol),n=a.currency_position,c=a.decimal_separator,o=a.number_of_decimals,a=a.thousand_separator,l=new RegExp("\\d(?=(\\d{3})+\\".concat(c,")"),"gi"),a="$&".concat(a),o=parseFloat(t).toFixed(o).replace(/\./,c).replace(l,a);return"decimal"==e?o:{left:"".concat(r,"<span>").concat(o,"</span>"),left_with_space:"".concat(r," <span>").concat(o,"</span>"),right:"<span>".concat(o,"</span>").concat(r),right_with_space:"<span>".concat(o,"</span> ").concat(r)}[n]},timeout:function(a,r){return new Promise(function(t,e){setTimeout(function(){e(new Error("request timeout"))},r),t(a.then(t,e))})}},wptravelcheckout=function(w){var a,e,d,t,r,n,c,u=document.getElementById("wp-travel-book-now");u&&u.addEventListener("wptcartchange",function(t){t.target.disabled=!0}),u&&u.addEventListener("click",function(t){}),!w||(t=w&&w.querySelectorAll("[data-cart-id]"))&&t.length<=0||(a=function(t){t?e.removeAttribute("style"):e.style.display="none"},(e=w.querySelector(".wp-travel-cart-loader"))&&a(!0),wp_travel&&wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?action=wp_travel_get_cart&_nonce=").concat(wp_travel._nonce)).then(function(t){t.json().then(function(t){a(),t.success&&"WP_TRAVEL_CART"===t.data.code&&t.data.cart&&(wp_travel_cart.cart=t.data.cart,Object.freeze(wp_travel_cart.cart))})}),1e4).catch(function(t){alert("[X] Request Timeout!"),a()}),d=function(t){var p=0,u=0,c=0,d=0,e=wp_travel_cart.cart&&wp_travel_cart.cart.cart_items&&wp_travel_cart.cart.cart_items[t],t=w.querySelector('[data-cart-id="'.concat(t,'"]')),s=e.trip_data.pricings.find(function(t){return t.id==parseInt(e.pricing_id)}),_=s.categories,o=s.trip_extras,v=t.querySelectorAll("[data-wpt-category-count]"),f=e.trip_data&&e.trip_data.minimum_partial_payout_percent,a=t.querySelectorAll("[data-wpt-category]"),y=0,a=(a.forEach(function(t){t=t.querySelector("[data-wpt-category-count-input]"),t=t&&parseInt(t.value)||0;y+=t}),a.forEach(function(e){var a,r,t=e.querySelector("[data-wpt-category-total]"),n=e.querySelector("[data-wpt-category-count-input]"),c=e.querySelector("[data-wpt-category-price]"),o=_.find(function(t){return t.id==parseInt(e.dataset.wptCategory)}),l=GetConvertedPrice(l=o&&o.is_sale?parseFloat(o.sale_price):parseFloat(o.regular_price)),i=(c.innerHTML=wp_travel_cart.format(l),n&&parseInt(n.value)||0),n=(void 0!==s.has_group_price&&s.has_group_price&&s.group_prices&&0<s.group_prices.length?(n=s.group_prices.sort((r=1,"-"===(a="max_pax")[0]&&(r=-1,a=a.substr(1)),function(t,e){return(t[a]<e[a]?-1:t[a]>e[a]?1:0)*r})).find(function(t){return parseInt(t.min_pax)<=y&&parseInt(t.max_pax)>=y}))&&n.price&&(l=GetConvertedPrice(l=parseFloat(n.price)),c&&(c.innerHTML=wp_travel_cart.format(l))):o.has_group_price&&((n=o.group_prices.find(function(t){return i>=parseInt(t.min_pax)&&i<=parseInt(t.max_pax)}))&&n.price&&(l=GetConvertedPrice(l=n.price)),c&&(c.innerHTML=wp_travel_cart.format(l))),"group"==o.price_per?0<i&&l||0:l*i);v&&v.forEach(function(t){t.dataset.wptCategoryCount==e.dataset.wptCategory&&(t.innerHTML=i)}),t&&(t.innerHTML=wp_travel_cart.format(n)),d+=parseFloat(n),p+=parseFloat(n),u+=parseFloat(n)*parseFloat(f)/100}),t.querySelectorAll("[data-wpt-tx]"));return a&&a.forEach(function(e){var t,a,r,n=o.find(function(t){return t.id==parseInt(e.dataset.wptTx)});n.tour_extras_metas&&(t=e.querySelector("[data-wpt-tx-total]"),r=e.querySelector("[data-wpt-tx-count-input]"),a=e.querySelector("[data-wpt-tx-price]"),n=GetConvertedPrice(n=n.is_sale&&n.tour_extras_metas.extras_item_sale_price||n.tour_extras_metas.extras_item_price),a.innerHTML=wp_travel_cart.format(n),a=r&&r.value||0,r=parseFloat(n)*parseInt(a),t&&(t.innerHTML=wp_travel_cart.format(r)),d+=r,c+=r)}),a={tripTotalWOExtras:p,tripTotalPartialWOExtras:u,extrasTotal:c,tripTotal:d},t.querySelector("[data-wpt-item-total]").innerHTML=wp_travel_cart.format(d),a},w&&w.addEventListener("wptcartchange",function(t){var e,a=0,r=0,n=0,c=document.querySelectorAll("[data-wpt-cart-net-total]"),o=document.querySelectorAll("[data-wpt-cart-partial-total]"),l=t.target.querySelector("[data-wpt-cart-subtotal]"),i=t.target.querySelector("[data-wpt-cart-discount]"),p=t.target.querySelector("[data-wpt-cart-tax]"),u=t.target.querySelectorAll("[data-cart-id]"),l=(u&&u.forEach(function(t){t=d(t.dataset.cartId);a+=t.tripTotal,t.tripTotalWOExtras,n+=t.tripTotalPartialWOExtras,r+=t.extrasTotal}),l&&(l.innerHTML=wp_travel_cart.format(a)),(t.detail&&t.detail.coupon||wp_travel_cart.cart.coupon&&wp_travel_cart.cart.coupon.coupon_id)&&(e=(l=t.detail&&t.detail.coupon||wp_travel_cart.cart.coupon).value&&parseInt(l.value)||0,i&&(i.innerHTML="fixed"==l.type?"- "+wp_travel_cart.format(e):"- "+wp_travel_cart.format(a*e/100),i.closest("[data-wpt-extra-field]").removeAttribute("style")),a="fixed"==l.type?a-e:a*(100-e)/100),wp_travel_cart.cart.total.discount<=0&&(i.closest("[data-wpt-extra-field]").style.display="none"),wp_travel_cart.cart.tax&&(p&&(p.innerHTML="+ "+wp_travel_cart.format(a*parseInt(wp_travel_cart.cart.tax)/100)),a=a*(100+parseInt(wp_travel_cart.cart.tax))/100),c&&c.forEach(function(t){return t.innerHTML=wp_travel_cart.format(a)}),o&&o.forEach(function(t){var e=n+r;wp_travel_cart.cart.tax&&(e=e*(100+parseFloat(wp_travel_cart.cart.tax))/100),t.innerHTML=wp_travel_cart.format(e)}),t.target.querySelector("[data-wpt-cart-item-count]"));l&&(l.innerHTML=u.length)}),t&&t.forEach(function(c){var t=c.querySelector("a.edit"),o=c.querySelector(".update-fields-collapse"),e=c.querySelector(".del-btn"),l=c.querySelector(".wp-travel-cart-loader"),t=(e&&e.addEventListener("click",function(t){t.preventDefault(),confirm(e.dataset.l10n)&&(a(!0),wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?action=wp_travel_remove_cart_item&_nonce=").concat(wp_travel._nonce,"&cart_id=").concat(c.dataset.cartId)).then(function(t){return t.json()}).then(function(t){t.success&&"WP_TRAVEL_REMOVED_CART_ITEM"==t.data.code&&(jQuery(document.body).trigger("wptravel_removed_cart_item",[t.data,c.dataset.cartId,e]),window.location.reload(),wp_travel_cart.cart=t.data.cart,t=t.data.cart.total,wp_travel.payment&&(wp_travel.payment.trip_price=parseFloat(t.total),wp_travel.payment.payment_amount=parseFloat(t.total_partial)),c.remove(),w.dispatchEvent(new Event("wptcartchange")),a())}),1e4).catch(function(t){alert("[X] Request Timeout!"),a()}))}),t&&t.addEventListener("click",function(t){var e,a,r,n;o.className.indexOf("active")<0?(o.style.display="block",o.classList.add("active")):(o.style.display="none",o.classList.remove("active")),o.className.indexOf("active")<0||(t=t.target.dataset.wptTargetCartId,(t=wp_travel_cart.cart.cart_items&&wp_travel_cart.cart.cart_items[t]||{}).trip_data&&t.trip_data.inventory&&"yes"===t.trip_data.inventory.enable_trip_inventory&&(e="",e=(e=(e+=(n=t.pricing_id||0)&&"pricing_id=".concat(n)||"")+((n=t.trip_data&&t.trip_data.id||0)&&"&trip_id=".concat(n)||""))+((n=t.trip_time)&&"&trip_time=".concat(n)||""),t.arrival_date&&"invalid date"!=new Date(t.arrival_date).toString().toLowerCase()&&(t=(n=new Date(t.arrival_date)).getFullYear(),a=n.getMonth()+1,a=String(a).padStart(2,"0"),r=String(n.getDate()).padStart(2,"0"),e+=(n="".concat(t,"-").concat(a,"-").concat(r))&&"&selected_date=".concat(n)||""),l.removeAttribute("style"),wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?").concat(e,"&action=wp_travel_get_inventory&_nonce=").concat(wp_travel._nonce)).then(function(t){return t.json().then(function(t){var e;l.style.display="none",t.success&&"WP_TRAVEL_INVENTORY_INFO"===t.data.code&&0<t.data.inventory.length&&(e=t.data.inventory[0],c.querySelectorAll("[data-wpt-category-count-input]").forEach(function(t){return t.max=e.pax_available}))})})).catch(function(t){alert("[X] Request Timeout!"),l.style.display="none"})))}),c.querySelectorAll("[data-wpt-category], [data-wpt-tx]"));t&&t.forEach(function(t){var r=t.querySelector("[data-wpt-category-count-input], [data-wpt-tx-count-input]"),t=t.querySelectorAll("[data-wpt-count-up],[data-wpt-count-down]");t&&t.forEach(function(a){a.addEventListener("click",function(t){t.preventDefault();var e=0;c.querySelectorAll("[data-wpt-category-count-input]").forEach(function(t){e+=parseInt(t.value)}),void 0!==a.dataset.wptCountUp&&(r&&r.dataset.wptCategoryCountInput?(t=parseInt(r.value)+1<0?0:parseInt(r.value)+1,e+1<=parseInt(r.max)&&t>=parseInt(r.min)&&(r.value=t)):r.value=parseInt(r.value)+1),void 0!==a.dataset.wptCountDown&&(r&&r.dataset.wptCategoryCountInput?(t=parseInt(r.value)-1<0?0:parseInt(r.value)-1,e-1<=parseInt(r.max)&&t>=parseInt(r.min)&&(r.value=t)):r.value=parseInt(r.value)-1<parseInt(r.min)?r.min:parseInt(r.value)-1),w.dispatchEvent(new Event("wptcartchange")),u&&u.dispatchEvent(new Event("wptcartchange")),c.querySelector('form [type="submit"]').disabled=!1,c.querySelector("h5 a").style.color="orange"})})})}),t&&t.forEach(function(c){var o=c.querySelector(".wp-travel-cart-loader"),l=c.querySelectorAll("[data-wpt-category]"),i=c.querySelectorAll("[data-wpt-tx]"),p=c.querySelector("form");p.addEventListener("submit",function(t){t.preventDefault();var a=p.querySelector('[type="submit"]'),t=(a.disabled=!0,o.removeAttribute("style"),c.dataset.cartId),r={},n=(l&&l.forEach(function(t){var e=t.querySelector("[data-wpt-category-count-input]"),t=t.dataset.wptCategory,e=e&&e.value;r=_objectSpread(_objectSpread({},r),{},_defineProperty({},t,e))}),{}),e=(i&&i.forEach(function(t){var e=t.querySelector("[data-wpt-tx-count-input]"),t=t.dataset.wptTx,e=e&&e.value;n=_objectSpread(_objectSpread({},n),{},_defineProperty({},t,e))}),{pax:r,wp_travel_trip_extras:{id:Object.keys(n),qty:Object.values(n)}});wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?action=wp_travel_update_cart_item&cart_id=").concat(t,"&_nonce=").concat(wp_travel._nonce),{method:"POST",body:JSON.stringify(e)}).then(function(t){return t.json()}).then(function(t){var e;o.style.display="none",t.success?(wp_travel_cart.cart=t.data.cart,e=void 0!==(t=t.data.cart&&void 0!==t.data.cart.total?t.data.cart.total:[]).total?t.total:0,t=void 0!==t.total_partial?t.total_partial:0,wp_travel.payment&&(wp_travel.payment.trip_price=parseFloat(e),wp_travel.payment.payment_amount=parseFloat(t)),e=w.querySelectorAll("[data-dirty]"),u&&(e&&0<e.length?u.disabled=!0:u.disabled=!1),c.querySelector("h5 a").removeAttribute("style"),location.reload()):a.disabled=!1}),1e4).catch(function(t){alert("[X] Request Timeout!"),o.style.display="none",a.disabled=!1})})}),(t=document.getElementById("wp-travel-payment-mode"))&&t.addEventListener("change",function(t){var e=document.querySelector("#shopping-cart"),a=e&&e.querySelector("[data-wpt-cart-partial-total]")&&e.querySelector("[data-wpt-cart-partial-total]").closest("p"),r=e&&e.querySelectorAll("[data-wpt-trip-partial-total]")&&e.querySelectorAll("[data-wpt-trip-partial-total]"),n=e&&e.querySelectorAll(".wp-travel-payable-amount")&&e.querySelector(".wp-travel-payable-amount"),e=e&&e.querySelectorAll("[data-wpt-trip-partial-gross-total]")&&e.querySelector("[data-wpt-trip-partial-gross-total]");"partial"===t.target.value?(a&&"none"==a.style.display&&a.removeAttribute("style"),r.forEach(function(t){return t.removeAttribute("style")}),e.removeAttribute("style"),e.classList.add("selected-payable-amount"),n.classList.remove("selected-payable-amount")):(a&&(a.style.display="none"),r.forEach(function(t){return t.style.display="none"}),e.style.display="none",e.classList.remove("selected-payable-amount"),n.classList.add("selected-payable-amount"))}),r=(t=document.getElementById("wp-travel-coupon-form"))&&t.querySelector("button"),(n=t&&t.querySelector(".coupon-input-field"))&&n.addEventListener("keyup",function(t){c(t.target),0<t.target.value.length&&t.target.removeAttribute("style")}),c=function(t,e){var a;e?((a=document.createElement("p")).classList.add("error"),a.innerHTML=e,t.after(a)):(e=t.parentElement.querySelector(".error"))&&e.remove()},r&&n&&r.addEventListener("click",function(e){e.preventDefault(),n.value.length<=0?(n.style.borderColor="red",n.focus()):(a(!0),e.target.disabled=!0,wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?action=wp_travel_apply_coupon&_nonce=").concat(wp_travel._nonce),{method:"POST",body:JSON.stringify({couponCode:n.value})}).then(function(t){return t.json()}).then(function(t){a(),t.success?(wp_travel_cart.cart=t.data.cart,n.toggleAttribute("readonly"),e.target.innerHTML=e.target.dataset.successL10n,e.target.style.backgroundColor="green",w.dispatchEvent(new CustomEvent("wptcartchange",{detail:{coupon:t.data.cart.coupon}})),location.reload()):(n.focus(),c(n,t.data[0].message),e.target.disabled=!1)}),1e4).catch(function(t){alert("[X] Request Timeout!"),a()}))}))};document.getElementById("shopping-cart")&&wptravelcheckout(document.getElementById("shopping-cart"));